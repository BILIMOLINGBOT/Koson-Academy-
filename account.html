<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mening Videolarim - @javlonbek</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }

    body {
      background-color: #0f0f0f;
      color: #fff;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
    }

    /* HEADER */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 0;
      margin-bottom: 30px;
      border-bottom: 1px solid #333;
    }

    .header h1 {
      font-size: 24px;
      color: #fff;
    }

    .upload-btn {
      background-color: #ff0000;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 20px;
      font-weight: 500;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: background-color 0.2s;
    }

    .upload-btn:hover {
      background-color: #cc0000;
    }

    /* VIDEO GRID */
    .video-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .video-card {
      background-color: #1a1a1a;
      border-radius: 10px;
      overflow: hidden;
      cursor: pointer;
      transition: transform 0.3s, box-shadow 0.3s;
    }

    .video-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
    }

    .video-thumbnail {
      width: 100%;
      height: 180px;
      background-color: #000;
      position: relative;
      overflow: hidden;
    }

    .video-thumbnail video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .play-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      transition: opacity 0.3s;
    }

    .video-card:hover .play-overlay {
      opacity: 1;
    }

    .play-icon {
      width: 60px;
      height: 60px;
      background: rgba(255, 0, 0, 0.8);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .video-info {
      padding: 15px;
    }

    .video-title {
      font-size: 16px;
      font-weight: 500;
      margin-bottom: 8px;
      line-height: 1.4;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .video-meta {
      display: flex;
      justify-content: space-between;
      color: #aaa;
      font-size: 13px;
    }

    .video-stats {
      display: flex;
      gap: 10px;
    }

    /* EMPTY STATE */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
    }

    .empty-icon {
      font-size: 64px;
      margin-bottom: 20px;
      opacity: 0.5;
    }

    .empty-title {
      font-size: 20px;
      margin-bottom: 10px;
      color: #fff;
    }

    .empty-description {
      color: #aaa;
      margin-bottom: 30px;
      max-width: 400px;
      margin-left: auto;
      margin-right: auto;
    }

    /* UPLOAD PROGRESS */
    .upload-progress {
      position: relative;
      border: 2px dashed #333;
    }

    .progress-overlay {
      position: absolute;
      bottom: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      color: white;
    }

    .progress-bar {
      width: 80%;
      height: 4px;
      background-color: #333;
      border-radius: 2px;
      margin: 10px 0;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background-color: #ff0000;
      transition: width 0.3s;
    }

    .progress-text {
      font-size: 12px;
      color: #aaa;
    }

    /* RESPONSIVE */
    @media (max-width: 768px) {
      .video-grid {
        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
        gap: 15px;
      }
      
      .header h1 {
        font-size: 20px;
      }
      
      .upload-btn {
        padding: 8px 16px;
        font-size: 14px;
      }
    }

    @media (max-width: 480px) {
      .video-grid {
        grid-template-columns: 1fr;
      }
      
      .container {
        padding: 15px;
      }
      
      .video-thumbnail {
        height: 160px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üìπ Mening Videolarim</h1>
      <button class="upload-btn" id="uploadBtn">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="7 10 12 15 17 10"/>
          <line x1="12" y1="15" x2="12" y2="3"/>
        </svg>
        Video Yuklash
      </button>
    </div>

    <div class="video-grid" id="videoGrid">
      <!-- Videolar bu yerga yuklanadi -->
    </div>
  </div>

  <script>
    // ========== INITIALIZATION ==========
    document.addEventListener('DOMContentLoaded', function() {
      initializeProfile();
    });

    function initializeProfile() {
      // Yangi video yuklash tugmasi
      const uploadBtn = document.getElementById('uploadBtn');
      uploadBtn.addEventListener('click', function() {
        window.location.href = 'update.html';
      });

      // Videolarni yuklash
      loadVideos();
    }

    // ========== VIDEO LOADING ==========
    function loadVideos() {
      const videoGrid = document.getElementById('videoGrid');
      let videos = JSON.parse(localStorage.getItem('userVideos')) || [];
      
      if (videos.length === 0) {
        videoGrid.innerHTML = `
          <div class="empty-state">
            <div class="empty-icon">üìπ</div>
            <h2 class="empty-title">Hech qanday video yo'q</h2>
            <p class="empty-description">Birinchi video yuklash uchun "Video Yuklash" tugmasini bosing</p>
            <button class="upload-btn" onclick="window.location.href='update.html'">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="7 10 12 15 17 10"/>
                <line x1="12" y1="15" x2="12" y2="3"/>
              </svg>
              Video Yuklash
            </button>
          </div>
        `;
        return;
      }
      
      // Videolarni teskarisi tartibda ko'rsatish (yangisi birinchi)
      videos.reverse().forEach((video, index) => {
        const videoCard = document.createElement('div');
        videoCard.className = 'video-card';
        videoCard.dataset.videoId = video.id;
        
        // Video preview
        const thumbnail = document.createElement('div');
        thumbnail.className = 'video-thumbnail';
        
        if (video.videoUrl) {
          const videoElement = document.createElement('video');
          videoElement.src = video.videoUrl;
          videoElement.muted = true;
          videoElement.playsInline = true;
          thumbnail.appendChild(videoElement);
        }
        
        // Play overlay
        const overlay = document.createElement('div');
        overlay.className = 'play-overlay';
        overlay.innerHTML = `
          <div class="play-icon">
            <svg width="24" height="24" viewBox="0 0 24 24" fill="#fff">
              <path d="M8 5v14l11-7z"/>
            </svg>
          </div>
        `;
        thumbnail.appendChild(overlay);
        
        // Upload progress
        if (video.status === 'uploading') {
          const progressOverlay = document.createElement('div');
          progressOverlay.className = 'progress-overlay';
          progressOverlay.innerHTML = `
            <svg width="30" height="30" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="7 10 12 15 17 10"/>
              <line x1="12" y1="15" x2="12" y2="3"/>
            </svg>
            <div class="progress-bar">
              <div class="progress-fill" style="width: ${video.progress || 0}%"></div>
            </div>
            <div class="progress-text">${video.progress || 0}% ‚Ä¢ Yuklanmoqda...</div>
          `;
          thumbnail.appendChild(progressOverlay);
          thumbnail.classList.add('upload-progress');
          
          // Progressni yangilash
          updateUploadProgress(video, progressOverlay, videos.length - 1 - index);
        }
        
        videoCard.appendChild(thumbnail);
        
        // Video ma'lumotlari
        const videoInfo = document.createElement('div');
        videoInfo.className = 'video-info';
        
        const title = document.createElement('h3');
        title.className = 'video-title';
        title.textContent = video.title || 'Nomsiz video';
        
        const meta = document.createElement('div');
        meta.className = 'video-meta';
        
        const time = document.createElement('div');
        time.textContent = video.timeAgo || 'hozirgina';
        
        const stats = document.createElement('div');
        stats.className = 'video-stats';
        stats.innerHTML = `
          <span>üëÅÔ∏è ${video.views || '0'}</span>
          <span>‚ù§Ô∏è ${video.likes || '0'}</span>
          <span>üí¨ ${video.comments || '0'}</span>
        `;
        
        meta.appendChild(time);
        meta.appendChild(stats);
        
        videoInfo.appendChild(title);
        videoInfo.appendChild(meta);
        videoCard.appendChild(videoInfo);
        
        // Video bosilganda videopage ga o'tish
        videoCard.addEventListener('click', function(e) {
          if (!e.target.closest('.progress-overlay')) {
            localStorage.setItem('currentVideo', JSON.stringify(video));
            window.location.href = 'videopage.html';
          }
        });
        
        videoGrid.appendChild(videoCard);
      });
    }

    // Yuklash progressini yangilash
    function updateUploadProgress(video, progressOverlay, originalIndex) {
      const progress = video.progress || 0;
      
      if (progress < 100) {
        // Yangi progress hisoblash
        const newProgress = Math.min(100, progress + Math.random() * 10);
        video.progress = newProgress;
        
        // LocalStorage ni yangilash
        let videos = JSON.parse(localStorage.getItem('userVideos')) || [];
        if (videos[originalIndex]) {
          videos[originalIndex].progress = newProgress;
          localStorage.setItem('userVideos', JSON.stringify(videos));
        }
        
        // UI ni yangilash
        const progressFill = progressOverlay.querySelector('.progress-fill');
        const progressText = progressOverlay.querySelector('.progress-text');
        
        if (progressFill) progressFill.style.width = newProgress + '%';
        if (progressText) progressText.textContent = `${Math.floor(newProgress)}% ‚Ä¢ Yuklanmoqda...`;
        
        if (newProgress < 100) {
          setTimeout(() => updateUploadProgress(video, progressOverlay, originalIndex), 500);
        } else {
          // Yuklash tugaganda statusni yangilash
          video.status = 'uploaded';
          videos[originalIndex].status = 'uploaded';
          localStorage.setItem('userVideos', JSON.stringify(videos));
          
          // Progress overlay ni olib tashlash
          setTimeout(() => {
            progressOverlay.remove();
            const thumbnail = document.querySelector('.upload-progress');
            if (thumbnail) thumbnail.classList.remove('upload-progress');
          }, 1000);
        }
      }
    }
  </script>
</body>
</html>