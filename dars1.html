<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>To Be Grammar Test</title>
  <style>
    /* CSS bu yerga yoziladi, progress bar, sahifalar, test dizayni */
  </style>
</head>
<body>
  <!-- ðŸ”µ Progress bar -->
  <div id="progressBarContainer"><div id="progressBar"></div></div>

  <!-- ðŸ”µ Har sahifa uchun alohida <div> -->
  <div class="page" id="page1"> ... dars matni ... <button onclick="nextPage()">Keyingi</button></div>
  <div class="page" id="page2"> ... test1 ... <button onclick="nextPage()">Keyingi</button></div>
  <div class="page" id="page3"> ... dars matni ... <button onclick="nextPage()">Keyingi</button></div>
  ...
  <div class="page" id="page7"> ... test3 ... </div>

  <!-- ðŸ”µ Firebase JS SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js"></script>
  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "...",
      authDomain: "...",
      projectId: "...",
      appId: "..."
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();
  </script>

  <!-- ðŸ”µ Javascript funksiyalar -->
  <script>
    let currentPage = 1;
    const totalPages = 7;
    const userId = "test_user"; // Telegram WebApp dan olinadi

    function showPage(n) {
      document.querySelectorAll('.page').forEach((el, i) => {
        el.style.display = (i === n - 1) ? 'block' : 'none';
      });
      updateProgressBar(n);
    }

    function nextPage() {
      if (currentPage < totalPages) {
        currentPage++;
        showPage(currentPage);
      }
    }

    function updateProgressBar(page) {
      const percent = (page / totalPages) * 100;
      document.getElementById("progressBar").style.width = percent + "%";
    }

    function saveTestResult(testId, isCorrect) {
      db.collection("users").doc(userId).set({
        [`test_${testId}`]: isCorrect,
        progress: currentPage
      }, { merge: true });
    }

    document.addEventListener("DOMContentLoaded", () => {
      showPage(currentPage);
    });
  </script>
</body>
</html>