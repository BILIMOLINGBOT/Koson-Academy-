<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>B1 Darslari</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: white;
      color: black;
      transition: background 0.3s, color 0.3s;
    }
    .dark-mode {
      background-color: #121212;
      color: white;
    }
    .back-btn {
      display: inline-block;
      padding: 10px 15px;
      background-color: #007bff;
      color: white;
      text-decoration: none;
      border-radius: 5px;
      margin-bottom: 15px;
      font-size: 16px;
      transition: background-color 0.3s;
    }
    .back-btn:hover {
      background-color: #0056b3;
    }
    h1 {
      text-align: center;
    }
    .lesson-container {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 10px;
      max-width: 600px;
      margin: auto;
    }
    button.lesson-btn {
      width: 100%;
      padding: 10px;
      font-size: 16px;
      background-color: #007bff;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: 0.3s;
    }
    button.lesson-btn:disabled {
      background-color: gray;
      cursor: not-allowed;
    }
    .progress-container {
      width: 90%;
      margin: 20px auto;
    }
    .progress-bar {
      height: 20px;
      background: #eee;
      border-radius: 10px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background: #007bff;
      width: 0%;
      transition: width 0.5s;
    }
    .score {
      text-align: center;
      margin-bottom: 10px;
    }
    .next-level-btn {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 16px;
      border: none;
      background-color: #28a745;
      color: white;
      border-radius: 8px;
      cursor: pointer;
      display: none;
    }
    .next-level-btn:hover {
      background-color: #218838;
    }
  </style>
</head>
<body>
  <a href="index.html" class="back-btn">← Orqaga</a>
  <h1>B1 Darslari</h1>
  <div class="progress-container">
    <div class="score">Ball: <span id="score">0</span></div>
    <div class="progress-bar">
      <div class="progress-fill" id="progress"></div>
    </div>
  </div>
  <div class="lesson-container" id="lessons"></div>

  <!-- B2 darajasiga o‘tish tugmasi -->
  <div style="text-align:center;">
    <button id="nextLevelBtn" class="next-level-btn" onclick="window.location.href='b2.html'">B2 darajasiga o'tish →</button>
  </div>

  <script>
    // Dark mode
    if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
      document.body.classList.add('dark-mode');
    }

    const lessonTitles = [
      "Modal verbs / can/could", "Modal verbs / must/need",
      "Modal verbs / should", "I have to ...", "Would you like ... ?",
      "There is vs There are", "There was vs There were",
      "There with other tenses", "What time is it?",
      "Simple Past Tense", "Past Continuous", "Past Perfect",
      "Future Simple", "Be going to", "Future Continuous",
      "Future Perfect", "Present Perfect Continuous",
      "Past Perfect Continuous"
    ];

    const container = document.getElementById("lessons");
    const scoreDisplay = document.getElementById("score");
    const progressFill = document.getElementById("progress");
    const nextLevelBtn = document.getElementById("nextLevelBtn");

    let unlockedLessons = parseInt(localStorage.getItem("b1_unlocked")) || 1;
    let score = parseInt(localStorage.getItem("b1_score")) || 0;

    function saveProgress() {
      localStorage.setItem("b1_unlocked", unlockedLessons);
      localStorage.setItem("b1_score", score);
    }

    function renderLessons() {
      container.innerHTML = "";
      lessonTitles.forEach((title, index) => {
        const btn = document.createElement("button");
        btn.textContent = `${index + 1}. ${title}`;
        btn.className = "lesson-btn";
        btn.disabled = index >= unlockedLessons;
        btn.onclick = () => {
          if (index >= unlockedLessons) {
            alert("Darslarni ketma-ket oʻrganish kerak");
          } else {
            if (index === unlockedLessons - 1) {
              score += 10;
              unlockedLessons++;
              saveProgress();
              updateProgress();
              renderLessons();
            }
            window.location.href = `dars${80 + index}.html`;
          }
        };
        container.appendChild(btn);
      });

      // B2 darajasiga yo'l ochish
      if (unlockedLessons > lessonTitles.length) {
        nextLevelBtn.style.display = "inline-block";
      } else {
        nextLevelBtn.style.display = "none";
      }
    }

    function updateProgress() {
      scoreDisplay.textContent = score;
      const percent = ((unlockedLessons - 1) / lessonTitles.length) * 100;
      progressFill.style.width = percent + "%";
    }

    renderLessons();
    updateProgress();
  </script>
</body>
</html>